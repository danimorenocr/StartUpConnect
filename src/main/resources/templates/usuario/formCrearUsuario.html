<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/layout :: head}"></head>

<body class="bg-white font-sans">
<header th:replace="~{layout/layout :: header}"></header>

  <div class="max-w-6xl mx-auto py-10 px-6">
    <h1 class="text-2xl font-bold text-slate-800 mb-6">Crear Usuario</h1>

    <!-- Selector de roles -->
    <div class="flex gap-4 mb-6">
      <button type="button" class="bg-sky-500 text-white px-4 py-2 rounded-full shadow">Emprendedor</button>
      <button type="button" class="bg-white text-slate-700 border px-4 py-2 rounded-full shadow">Mentor</button>
      <button type="button" class="bg-white text-slate-700 border px-4 py-2 rounded-full shadow">Visitante</button>
    </div>

    <form th:action="@{/crearUsuario}" method="post" enctype="multipart/form-data" th:object="${usuario}" id="formUsuario" class="grid grid-cols-1 md:grid-cols-3 gap-8">

      <!-- Columna izquierda: campos -->
      <div class="space-y-4 col-span-2">
        <div>
          <label for="documento" class="block text-sm font-medium text-slate-600">Documento:</label>
          <input th:field="*{documento}" type="text" id="documento" name="documento"
                 class="w-full rounded-md border px-4 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-300" />
        </div>

        <div>
          <label for="nombre" class="block text-sm font-medium text-slate-600">Nombre:</label>
          <input th:field="*{nombreUsu}" type="text" id="nombre" name="nombre"
                 class="w-full rounded-md border px-4 py-2 shadow-sm" />
        </div>

        <div>
          <label for="email" class="block text-sm font-medium text-slate-600">Email:</label>
          <input th:field="*{emailUsu}" type="email" id="email" name="email"
                 class="w-full rounded-md border px-4 py-2 shadow-sm" />
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-slate-600">Contraseña:</label>
          <input th:field="*{contrasenna}" type="password" id="password" name="password"
                 class="w-full rounded-md border px-4 py-2 shadow-sm" />
        </div>

        <div>
          <label for="telefono" class="block text-sm font-medium text-slate-600">Teléfono:</label>
          <input th:field="*{telefono}" type="tel" id="telefono" name="telefono"
                 class="w-full rounded-md border px-4 py-2 shadow-sm" />
        </div>

        <div>
          <label for="rol" class="block text-sm font-medium text-slate-600">Rol:</label>
          <select id="rol" name="rol" onchange="redirigirPorRol(this.value)"
                  class="w-full rounded-md border px-4 py-2 shadow-sm">
            <option value="">Seleccione un rol</option>
            <option th:each="r : ${roles}" th:value="${r.idRol}" th:data-rol="${r.rol}" th:text="${r.rol}"></option>
          </select>
        </div>
      </div>

      <!-- Columna derecha: imagen y resumen -->
      <div class="space-y-6">
        <div class="bg-blue-50 p-4 rounded-lg shadow text-center">
          <span class="inline-block bg-sky-700 text-white px-4 py-1 rounded-full text-sm mb-3">Emprendedor</span>
          <img id="preview" src="https://via.placeholder.com/100" alt="Previsualización"
               class="w-24 h-24 mx-auto rounded-full object-cover border-2 border-white shadow" />
          <p class="mt-2 text-sm text-slate-600" th:text="*{documento}">10507891362</p>
          <p class="font-semibold text-slate-800" th:text="*{nombreUsu}">Juan Luis Londoño</p>
          <p class="text-sm text-slate-600" th:text="*{emailUsu}">juanluis@gmail.com</p>
          <p class="text-sm text-slate-600" th:text="*{telefono}">3118458963</p>
        </div>

        <div>
          <label for="foto" class="block text-sm font-medium text-slate-600 mb-1">Imagen:</label>
          <input type="file" id="foto" name="foto" accept="image/*"
                 class="w-full rounded-md border px-4 py-2 shadow-sm" />
        </div>

        <button type="submit" class="w-full bg-sky-400 text-white font-semibold py-2 rounded-full shadow hover:bg-sky-500 transition">Guardar</button>
      </div>
    </form>
  </div>

  <script>
    const imagenInput = document.getElementById('foto');
    const preview = document.getElementById('preview');

    imagenInput.addEventListener('change', function () {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          preview.src = e.target.result;
        }
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>
