<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout/layout :: head}">

</head>

<body class="bg-gray-100">
<header th:replace="~{layout/layout :: header}"></header>
<link rel="stylesheet" th:href="@{/css/etapasEmprendedor.css}" href="/css/etapasEmprendedor.css">
<!-- Banner similar a 'Mis Startups' -->
<div class="banner-etapas">
    <img src="/images/bannerMentores.jpg" alt="Banner etapas" class="banner-img">
    <div class="banner-overlay">
        <h1 class="banner-title">Mis Etapas</h1>
        <p class="banner-desc">Sigue tu progreso y trabaja con mentores expertos.</p>
    </div>
</div>
<main class="main-container minimal-main">
    <div th:if="${not #lists.isEmpty(etapas)}">
        <div th:each="etapa, etapaStat : ${etapas}" class="etapa-card minimal-etapa-card">
            <!-- Mentor arriba -->
            <div class="mentor-section mentor-section-top minimal-mentor">
                <div class="mentor-img-box">
                    <img th:src="${mentoresPorEtapa.get(etapa.id).usuario != null && mentoresPorEtapa.get(etapa.id).usuario.fotoUrl != null ? mentoresPorEtapa.get(etapa.id).usuario.fotoUrl : '/images/sinfoto.jpg'}" alt="Foto del mentor" class="mentor-img">
                </div>
                <div class="mentor-info">
                    <div class="mentor-nombre" th:text="${mentoresPorEtapa.get(etapa.id) != null && mentoresPorEtapa.get(etapa.id).usuario != null ? mentoresPorEtapa.get(etapa.id).usuario.nombreUsu : 'Sin mentor asignado'}">Nombre del Mentor</div>
                    <div class="mentor-especialidad" th:if="${mentoresPorEtapa.get(etapa.id) != null}" th:text="${mentoresPorEtapa.get(etapa.id).especialidad}">Especialidad</div>
                    <a th:if="${mentoresPorEtapa.get(etapa.id) != null && mentoresPorEtapa.get(etapa.id).linkedin != null}" th:href="${mentoresPorEtapa.get(etapa.id).linkedin}" target="_blank" class="mentor-linkedin"><i class="fab fa-linkedin"></i>Perfil</a>
                </div>
            </div>
            <!-- Encabezado Etapa -->
            <div class="etapa-header minimal-etapa-header">
                <div>
                    <h2 class="etapa-titulo minimal-etapa-titulo" th:text="${etapa.titulo}">Nombre de la Etapa</h2>
                    <p class="etapa-desc minimal-etapa-desc" th:text="${etapa.descripcion}">Descripción de la etapa</p>
                </div>
                <div class="etapa-num-organizada minimal-etapa-num">
                    <span class="etapa-num-circulo">[[${etapaStat.index + 1}]]</span>
                </div>
            </div>
            <div>
                <h3 class="tareas-header minimal-tareas-header"><i class="fas fa-tasks"></i> Tareas</h3>
                <div class="tareas-count minimal-tareas-count">
                    <span th:text="${#lists.size(tareasPorEtapa.get(etapa.id))} + ' tareas'">0 tareas</span>
                </div>
                <div th:if="${not #lists.isEmpty(tareasPorEtapa.get(etapa.id))}" class="tareas-lista minimal-tareas-lista">
                    <div th:each="tarea : ${tareasPorEtapa.get(etapa.id)}" class="tarea-lista-item minimal-tarea-item">
                        <div class="tarea-lista-info minimal-tarea-info">
                            <h4 class="tarea-titulo minimal-tarea-titulo" th:text="${tarea.titulo}">Título de la tarea</h4>
                            <p class="tarea-desc minimal-tarea-desc" th:text="${tarea.descripcion}">Descripción detallada de la tarea</p>
                        </div>
                        <div class="tarea-lista-datos minimal-tarea-datos">
                            <span class="tarea-fecha minimal-tarea-fecha"><i class="far fa-calendar"></i> <span th:text="${#dates.format(tarea.fechaEntrega, 'dd/MM/yyyy')}">01/06/2025</span></span>
                            <a th:href="@{/verTarea/{id}(id=${tarea.id})}" class="tarea-detalles minimal-tarea-detalles"><i class="fas fa-eye"></i></a>
                        </div>
                    </div>
                </div>
                <div th:if="${#lists.isEmpty(tareasPorEtapa.get(etapa.id))}" class="tarea-card minimal-tarea-vacia">
                    <i class="fas fa-clipboard-list"></i>
                    <div>No hay tareas asignadas</div>
                </div>
            </div>
            <!-- Botón de feedback para calificar al mentor de la etapa -->
            <div class="feedback-mentor-btn-box" style="margin: 10px 0; text-align:right;">
                <a th:href="@{/feedback/calificarMentor/{etapaId}(etapaId=${etapa.id})}" class="btn btn-feedback-mentor">
                    <i class="fas fa-star"></i> Calificar Mentor
                </a>
            </div>
        </div>
    </div>
    <div th:if="${#lists.isEmpty(etapas)}" class="sin-etapas minimal-sin-etapas">
        <div class="sin-etapas-box minimal-sin-etapas-box">
            <div class="sin-etapas-icon minimal-sin-etapas-icon"><i class="fas fa-route"></i></div>
            <div class="sin-etapas-titulo minimal-sin-etapas-titulo">No hay etapas disponibles</div>
            <div class="sin-etapas-desc minimal-sin-etapas-desc">Las etapas de desarrollo aparecerán aquí una vez asignadas por el administrador.</div>
        </div>
    </div>
</main>
</body>

</html>
