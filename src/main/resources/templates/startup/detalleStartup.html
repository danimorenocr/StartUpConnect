<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle de Startup</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/startup/detalleStartup.css}">
</head>

<body class="main-bg">


    <div class="hero-section">
        <div class="overlay"></div>
        <div class="hero-content">
            <h1 class="hero-title">Perfil de Startup</h1>
            <p class="hero-subtitle">Innovación y emprendimiento en la comunidad StartUp Connect</p>
        </div>
    </div>

    <div class="container">
        <div class="main-content">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <img th:src="${startupDetalle.logoUrl != null ? startupDetalle.logoUrl : '/images/sinfoto.jpg'}" 
                             alt="Logo de la startup" class="avatar-img">
                        <div class="status-indicator active"></div>
                    </div>                    
                    <div class="profile-title">
                        <h2 class="profile-name" th:text="${startupDetalle.nombreStartup}">Nombre Startup</h2>
                        <div class="profile-badges">
                            <span class="profile-badge sector"><span class="badge-label">Sector:</span> <span th:text="${startupDetalle.sector}">Energía Renovable</span></span>
                            <span class="profile-badge estado"><span class="badge-label">Etapa:</span> <span th:text="${startupDetalle.estado}">Validación</span></span>
                        </div>
                    </div>
                </div>
                  <div class="stats-container">                    <div class="stat-item">
                        <!-- Mostrar botón de like solo para emprendedores e inversionistas -->
                        <div sec:authorize="hasAnyRole('ADMIN', 'INVERSIONISTA', 'EMPRENDEDOR')">
                            <form th:action="@{/startup/{id}/like(id=${startupDetalle.id})}" method="post" class="like-form">
                                <button type="submit" class="like-button" th:classappend="${hasLiked} ? 'liked' : ''">
                                    <i class="fas fa-heart" th:classappend="${hasLiked} ? 'liked-heart' : ''"></i>
                                    <span class="stat-number" th:text="${startupDetalle.cantLikes}">0</span>
                                </button>
                            </form>
                            <span class="stat-label" th:text="${hasLiked} ? 'Te gusta' : 'Likes'">Likes</span>
                        </div>
                        
                        <!-- Mensaje para mentores -->
                        <div sec:authorize="hasRole('MENTOR')" class="mentor-like-info">
                            <div class="stat-display">
                                <i class="fas fa-heart like-icon-disabled"></i>
                                <span class="stat-number" th:text="${startupDetalle.cantLikes}">0</span>
                            </div>
                            <span class="stat-label">Likes</span>
                            <small class="mentor-message">Los mentores no pueden dar like</small>
                        </div>
                        
                        <!-- Mostrar solo el número de likes para usuarios no autenticados -->
                        <div sec:authorize="!isAuthenticated()" class="guest-like-info">
                            <div class="stat-display">
                                <i class="fas fa-heart like-icon-disabled"></i>
                                <span class="stat-number" th:text="${startupDetalle.cantLikes}">0</span>
                            </div>
                            <span class="stat-label">Likes</span>
                            <small class="guest-message">Inicia sesión para dar like</small>
                        </div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-date" th:text="${#temporals.format(startupDetalle.fechaCreacion, 'dd/MM/yyyy')}">01/01/2023</span>
                        <span class="stat-label">Fecha creación</span>
                    </div>
                </div>
                
<div class="info-cards-container">
    <div class="top-cards">
        <!-- Tarjeta de descripción -->
        <div class="info-card description-info">
            <div class="card-header">
                <div class="header-icon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <h3>Descripción</h3>
            </div>
            <div class="card-body">
                <p class="description-text" th:text="${startupDetalle.descripcion}">Descripción de la startup</p>
            </div>
        </div>

        <!-- Tarjeta de Emprendedor -->
        <div class="info-card emprendedor-info">
            <div class="card-header">
                <div class="header-icon">
                    <i class="fas fa-user-tie"></i>
                </div>
                <h3>Emprendedor</h3>
            </div>
            <div class="card-body">
                <div class="emprendedor-card">
                    <div class="emprendedor-avatar">
                        <img th:src="${startupDetalle.emprendedor != null && startupDetalle.emprendedor.usuario != null && startupDetalle.emprendedor.usuario.fotoUrl != null ? startupDetalle.emprendedor.usuario.fotoUrl : '/images/sinfoto.jpg'}" 
                             alt="Foto del emprendedor">
                    </div>
                    <div class="emprendedor-details">
                        <h4 th:text="${startupDetalle.emprendedor != null && startupDetalle.emprendedor.usuario != null ? startupDetalle.emprendedor.usuario.nombreUsu : 'No disponible'}">Nombre Emprendedor</h4>
                        <p><i class="fas fa-envelope"></i> <span th:text="${startupDetalle.emprendedor != null && startupDetalle.emprendedor.usuario != null ? startupDetalle.emprendedor.usuario.emailUsu : 'No disponible'}">email@example.com</span></p>
                        <p><i class="fas fa-graduation-cap"></i> <span th:text="${startupDetalle.emprendedor != null ? startupDetalle.emprendedor.universidad : 'No disponible'}">Universidad</span></p>
                        <p><i class="fas fa-book"></i> <span th:text="${startupDetalle.emprendedor != null ? startupDetalle.emprendedor.programaEducativo : 'No disponible'}">Programa Educativo</span></p>

                        <a th:if="${startupDetalle.emprendedor != null && startupDetalle.emprendedor.usuario != null && startupDetalle.emprendedor.usuario.emailUsu != null}" 
                           th:href="@{'mailto:' + ${startupDetalle.emprendedor.usuario.emailUsu} + '?subject=Contacto sobre ' + ${startupDetalle.nombreStartup}}" 
                           class="btn-contactar">
                           <i class="fas fa-envelope"></i> Contactar
                        </a>

                        <a th:if="${startupDetalle.emprendedor != null}" 
                           th:href="@{/verEmprendedor/{id}(id=${startupDetalle.emprendedor.documento})}" 
                           class="btn-ver-perfil">
                           <i class="fas fa-user"></i> Ver perfil
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-cards">
        <!-- Tarjeta de Material Multimedia -->
        <div class="info-card multimedia-info">
            <div class="card-header">
                <div class="header-icon">
                    <i class="fas fa-photo-video"></i>
                </div>
                <h3>Material Multimedia</h3>
            </div>
            <div class="card-body">
                <div class="multimedia-links">
                    <a th:if="${startupDetalle.pitchUrl != null && !startupDetalle.pitchUrl.isEmpty()}"
                       th:href="${startupDetalle.pitchUrl}" class="multimedia-link" target="_blank">
                       <i class="fas fa-file-pdf"></i> Pitch Deck
                    </a>

                    <a th:if="${startupDetalle.videoPresentacion != null && !startupDetalle.videoPresentacion.isEmpty()}"
                       th:href="${startupDetalle.videoPresentacion}" class="multimedia-link" target="_blank">
                       <i class="fas fa-video"></i> Video de presentación
                    </a>
                </div>

                <div th:if="${startupDetalle.videoPresentacion != null && !startupDetalle.videoPresentacion.isEmpty() && #strings.contains(startupDetalle.videoPresentacion, 'youtube')}"
                     class="video-container">
                    <iframe th:src="${#strings.replace(startupDetalle.videoPresentacion, 'watch?v=', 'embed/')}"
                        frameborder="0"
                        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Tarjeta de Sitio Web -->
        <div class="info-card website-info" th:if="${startupDetalle.paginaWeb != null && !startupDetalle.paginaWeb.isEmpty()}">
            <div class="card-header">
                <div class="header-icon">
                    <i class="fas fa-globe"></i>
                </div>
                <h3>Sitio Web</h3>
            </div>
            <div class="card-body">
                <a th:href="${startupDetalle.paginaWeb}" class="website-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i>
                    <span th:text="${startupDetalle.paginaWeb}">https://ejemplo.com</span>
                </a>
            </div>
        </div>
    </div>
</div>

                
                <div class="social-section">
                    <h3 class="social-title">Conéctate con <span th:text="${startupDetalle.nombreStartup}">la startup</span></h3>
                    <div class="social-links-full">
                        <a th:if="${startupDetalle.github != null && !startupDetalle.github.isEmpty()}"
                           th:href="${startupDetalle.github}" target="_blank" title="GitHub" class="social-icon github">
                            <i class="fab fa-github"></i>
                        </a>
                        <a th:if="${startupDetalle.linkedin != null && !startupDetalle.linkedin.isEmpty()}"
                           th:href="${startupDetalle.linkedin}" target="_blank" title="LinkedIn" class="social-icon linkedin">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a th:if="${startupDetalle.instagram != null && !startupDetalle.instagram.isEmpty()}"
                           th:href="${startupDetalle.instagram}" target="_blank" title="Instagram" class="social-icon instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a th:if="${startupDetalle.paginaWeb != null && !startupDetalle.paginaWeb.isEmpty()}"
                           th:href="${startupDetalle.paginaWeb}" target="_blank" title="Sitio Web" class="social-icon website">
                            <i class="fas fa-globe"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="acciones">
            <a th:href="@{/vitrina}">
                <button type="button" class="btn-volver">
                    <i class="fas fa-arrow-left"></i> Volver
                </button>
            </a>
        </div>
    </div>
      <!-- Sección de comentarios -->
    <div class="comments-section">
        <h2 class="comments-title">Comentarios</h2>
        
        <!-- Mensajes de éxito y error -->
        <div th:if="${error}" class="alert alert-danger" role="alert">
            <span th:text="${error}">Error</span>
        </div>
        <div th:if="${mensajeExito}" class="alert alert-success" role="alert">
            <span th:text="${mensajeExito}">Éxito</span>
        </div>
        
        <!-- Formulario de comentarios -->
        <div sec:authorize="hasRole('INVERSIONISTA')" class="comment-form">
            <form th:action="@{/startup/{id}/comentar(id=${startupDetalle.id})}" method="post">
                <div class="form-group">
                    <textarea name="comentario" required class="form-control" 
                            rows="4" placeholder="Escribe tu comentario aquí..."></textarea>
                </div>
                <button type="submit" class="btn-submit">
                    <i class="fas fa-paper-plane"></i>
                    Enviar comentario
                </button>
            </form>
        </div>

        <!-- Lista de comentarios -->
        <div class="comments-list">
            <div th:each="comentario : ${comentarios}" class="comment">
                <div class="comment-header">
                    <img th:src="${comentario.usuario.fotoUrl != null ? comentario.usuario.fotoUrl : '/images/sinfoto.jpg'}" 
                         alt="Foto de perfil" class="comment-avatar">
                    <div class="comment-info">
                        <div class="user-info">
                            <h4 th:text="${comentario.usuario.nombreUsu}" class="comment-author">Nombre del Usuario</h4>                            
                            <span th:with="pattern='dd/MM/yyyy HH:mm'" th:text="${#temporals.format(comentario.fechaComentario, pattern)}" 
                                  class="comment-date">
                                <i class="far fa-clock"></i> Fecha
                            </span>
                        </div>
                    </div>
                </div>
                <p th:text="${comentario.comentario}" class="comment-text"></p>
            </div>

            <div th:if="${comentarios.empty}" class="no-comments">
                <p>
                    <i class="far fa-comments"></i>
                    No hay comentarios todavía. ¡Sé el primero en comentar!
                </p>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <img src="/images/StartUpConnect.png" alt="StartUp Connect Logo" class="footer-logo">
                <p>Conectando talento e innovación</p>
            </div>
            <div class="footer-links">
                <h4>Explora</h4>
                <ul>
                    <li><a href="/" class="footer-link">Inicio</a></li>
                    <li><a href="/vitrina" class="footer-link">Startups</a></li>
                    <li><a href="/vitrina" class="footer-link">Emprendedores</a></li>
                </ul>
            </div>
            <div class="footer-contact">
                <h4>Contacto</h4>
                <p><i class="fas fa-envelope"></i> info@startupconnect.com</p>
                <p><i class="fas fa-phone"></i> +57 300 123 4567</p>
                <div class="social-icons">
                    <a href="#" class="social-icon"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
        <p>&copy; 2025 StartUp Connect. Todos los derechos reservados.</p>
      </div>
    </div>
</body>

</html>